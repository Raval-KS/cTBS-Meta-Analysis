# cTBS-Meta-Analysis
A systematic review and meta-analysis of cTBS for auditory hallucinations.



## 📖 Overview
This repository contains the full analysis workflow, data processing scripts, and outputs for a systematic review and meta-analysis investigating the **efficacy and safety of continuous theta burst stimulation (cTBS)** for treating **auditory hallucinations in schizophrenia**.  

The project was conducted entirely in **RStudio**, using a transparent, reproducible pipeline that covers everything from systematic searching to final GRADE assessment.  

---

## 🔍 Research Objectives
1. **Primary Aim:** Evaluate the impact of cTBS on the severity of auditory hallucinations, measured by standardized clinical scales.  
2. **Secondary Aims:** Assess effects on related clinical domains and safety:
   - PANSS-Positive symptoms
   - PANSS-Negative symptoms
   - PANSS-P3 subscale
   - AHRS/AVHRS (Auditory Hallucination Rating Scales)
   - Response Rate (≥25% reduction in PSYRATS score)
   - Adverse Events  
3. **Exploratory Aims:**  
   - Identify sources of heterogeneity  
   - Evaluate robustness of findings (sensitivity analyses)  
   - Assess certainty of evidence using the GRADE framework  

---

## 📂 Repository Structure (in sequence)
1.0Intro Table- Introduction table desrbiing the characteristics of included studies
1.1main forest plot- Code to carry out the meta analysis of primary outcome(PSYRATS) using REML method and output forest plot
1.2.1.Sensitivty models: testing robustness of results of main forest plot by creating different models for 3 different correlation assumptions(r=0.3/0.5/0.7) to prove consistency accross different assumed correlations
1.2.2Results sensitivity anlysis: Visually represent results from sensitivity models
1.3.LOO Ma: leave one out meta analysis to test for heterogeneity contributors
1.4.Buaujats plot : visually represent outlier study
1.5.HKSJ adjustment : results after excluding outlier study and using a conservative model for calculations
1.6.subgroup analysis : analysis by different subgroups and check for heterogeneity contributors
1.7.Secondary outcomes : assess results of various secondary outcomes (listed below)
1.8.RoB assesment : visual representation of RoB
1.9.GRADE assesment: summary of evidence generated by study 

(note: till_metareg_8a is an exploratory file, its results have not been included in study)


## 📊 Methods

### Systematic Search
- **Databases:** PubMed/MEDLINE, Embase, Web of Science, Scopus, Cochrane CENTRAL  
- **Other Sources:** ClinicalTrials.gov, reference list hand-searching, conference abstracts  
- **Search Terms:** `"cTBS" AND "auditory hallucinations" AND "schizophrenia"` (expanded with synonyms)  
- **Records Identified:** 319 → 5 included studies (PRISMA diagram in `/prisma/`)  

### Statistical Analysis
- **Software:** R (RStudio)  
- **Key Packages:** `meta`, `dplyr`, `ggplot2`, `kableExtra`  
- **Model:** Random-effects (REML) for pooled estimates  
- **Effect Measures:**  
  - Continuous: MD (Mean Difference) or SMD (Hedges’ g)  
  - Dichotomous: Risk Ratio (RR)  

### Sensitivity Analyses
- Leave-One-Out (LOO) meta-analysis  
- Baujat plot (influence diagnostics)  
- Hartung-Knapp adjustment  
- Subgroup analyses (e.g., stimulation site, session count, frequency)  

### Risk of Bias & Certainty
- Cochrane RoB 2 tool (weighted plot)  
- GRADE framework: 5 domains (risk of bias, inconsistency, indirectness, imprecision, publication bias)  

---

## 📈 Key Results

### Primary Outcome
- **Mean Difference (MD):** -2.97 (95% CI: -5.22 to -0.73), favoring cTBS  
- **Heterogeneity:** I² = 68.3% (substantial)  
- **Certainty:** Very Low (GRADE), downgraded for RoB, heterogeneity, and imprecision  

### Secondary Outcomes
- PANSS-Positive → Significant benefit (pooled MD negative)  
- PANSS-Negative, PANSS-P3, AHRS/AVHRS → No significant effect  
- Response Rate → Trend towards benefit, RR > 1 (not significant)  
- Adverse Events → No increase (favorable safety profile)  

### Sensitivity
- LOO showed Liu et al. (2023) as main driver of heterogeneity  
- HKSJ adjustment confirmed robustness of core effect  
- Subgroup analyses did not explain heterogeneity  

---

